import{s as A,j as c,t as L}from"./transform.D34fbgXt.js";import{l as R,a as M,b as T,c as Y,u as D,m as y,p as X,f as G,d as H}from"./map.Crg4iWOe.js";import{r as x}from"./index.BVOCwoKb.js";import{s as o}from"./styles_module.b6769e26.7dQe8EHB.js";import{r as I}from"./range.DLCk2Tlt.js";import{n as J,f as K}from"./forEach.Dps42lNb.js";import{l as $}from"./last.DXTTfs9a.js";const t={container:{class:"flex flex-col "},display:{width:600,height:300,class:"p-0  mb-0 w-full h-auto "},controls:{width:600,height:170,class:"d3-widgets p-0  mb-0 w-full h-auto ",grid:{x:12,y:12}},widgets:{slider_size:500,slider_girth:10,slider_knob:12,slider_fontsize:18,sliders:[{id:"sigma",label:"noise strength",range:[0,.25],value:.005,position:{x:1,y:2.5}},{id:"k",label:"force strength",range:[-3,3],value:1,position:{x:1,y:6}}],buttons:[{id:"play_pause",actions:["play","pause"],value:0,position:{x:4,y:9.5}},{id:"reset",actions:["rewind"],value:0,position:{x:8,y:9.5}}]},plot:{margin:{l:30,r:30,t:10,b:30},xr:[0,10],yr:[-2,2],xaxis:{label:"t",label_position:{x:280,y:190},fontsize:"16px"},yaxis:{label:"X(t)",label_position:{x:175,y:20},fontsize:"16px"}}},i=.01,O=10,k=t.plot.xr[1];var l=t.plot.xr;const P=t.plot.yr,p=R().domain(l).range([t.plot.margin.l,t.display.width-t.plot.margin.r]),b=R().domain(P).range([t.display.height-t.plot.margin.b,t.plot.margin.t]),w=M(p),Q=T(b),E=Y().x(e=>p(e.t)).y(e=>b(e.X));var d=[],u=0,N={};const S=J(0,1);function at({id:e}){const B=x.useRef(null),v=x.useRef(null),j=x.useRef(null);return x.useEffect(()=>{console.log(d);const z=D(t.controls.width,t.controls.height,t.controls.grid.x,t.controls.grid.y),a=A(v.current),h=A(j.current),C=()=>{u++;let s=m[1].value(),f=m[0].value();K(d,r=>{let q=$(r.trajectory).t,n=$(r.trajectory).X;r.trajectory.push({t:q+i,X:n+s*i*n-i*n*n*n+Math.sqrt(f*i)*S()}),u>k/i/2&&r.trajectory.shift()}),u>k/i/2&&(l=[l[0]+i,l[1]+i],p.domain(l),a.select("#xaxis").call(w)),a.selectAll("."+o.agent).data(d).attr("d",r=>E(r.trajectory))},_=()=>{u=0,d=y(I(O),(s,f)=>({id:f,trajectory:[{t:0,X:0}]})),l=t.plot.xr,p.domain(l),a.select("#xaxis").call(w),a.selectAll("."+o.agent).remove(),a.selectAll("."+o.agent).data(d).enter().append("path").attr("d",s=>E(s.trajectory)).attr("class",o.agent).classed(o.singular,s=>s.id==0)},g=y(t.widgets.buttons,s=>G().id(s.id).value(s.value).actions(s.actions).position(z.position(s.position.x,s.position.y))),m=y(t.widgets.sliders,s=>H().id(s.id).label(s.label).range(s.range).value(s.value).fontsize(t.widgets.slider_fontsize).size(t.widgets.slider_size).girth(t.widgets.slider_girth).knob(t.widgets.slider_knob).position(z.position(s.position.x,s.position.y)));_();function F(s){g[0].value()==1?N=L(C,0):N.stop()}return g[0].update(F),g[1].update(_),h.selectAll(null).data(g).enter().append(X),h.selectAll(null).data(m).enter().append(X),a.append("g").datum(t.plot.xaxis).attr("class",o.axis).attr("id","xaxis").attr("transform",function(s){return"translate(0,"+b(0)+")"}).call(w).style("font-size",t.plot.xaxis.fontsize),a.append("g").datum(t.plot.yaxis).attr("class",o.axis).attr("transform",function(s){return"translate("+p(0)+",0)"}).call(Q).style("font-size",t.plot.xaxis.fontsize),()=>{h.selectAll("*").remove(),a.selectAll("*").remove()}},[e]),c.jsx(c.Fragment,{children:c.jsxs("div",{ref:B,id:e,className:t.container.class,children:[c.jsx("svg",{ref:v,id:`${e}-display`,className:t.display.class,width:t.display.width,height:t.display.height,viewBox:`0 0 ${t.display.width} ${t.display.height}`}),c.jsx("svg",{ref:j,id:`${e}-controls`,className:t.controls.class,width:t.controls.width,height:t.controls.height,viewBox:`0 0 ${t.controls.width} ${t.controls.height}`})]})})}export{at as default};
